---
- name: Deploy NGINX Ingress Controller
  k8s:
    state: present
    definition:
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: ingress-nginx-controller
        namespace: ingress-nginx
      spec:
        replicas: 1
        selector:
          matchLabels:
            app: ingress-nginx
        template:
          metadata:
            labels:
              app: ingress-nginx
          spec:
            containers:
              - name: controller
                image: k8s.gcr.io/ingress-nginx/controller:v1.9.1
